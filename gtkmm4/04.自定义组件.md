# 自定义组件

一个简单的自定义组件：

```c++
#include "glibmm/refptr.h"
#include "gtkmm/enums.h"
#include "gtkmm/widget.h"

class RaWidget : public Gtk::Widget {
public:
    RaWidget();
    RaWidget(const RaWidget&) = delete;
    RaWidget(RaWidget&&) noexcept = default;
    RaWidget& operator=(const RaWidget&) = delete;
    RaWidget& operator=(RaWidget&&) noexcept = default;

    virtual ~RaWidget() = default;

protected:
    Gtk::SizeRequestMode get_request_mode_vfunc() const override;
    void measure_vfunc(Gtk::Orientation orientation,
                       int for_size,
                       int& minimum,
                       int& natural,
                       int& minimum_baseline,
                       int& natural_baseline) const override;
    void on_map() override;
    void on_unmap() override;
    void on_realize() override;
    void on_unrealize() override;
    void snapshot_vfunc(const Glib::RefPtr<Gtk::Snapshot>& snapshot) override;
};
```

定义：

```c++
#include "ra-widget.h"

#include <iostream>

#include "glibmm/objectbase.h"
#include "gtkmm/enums.h"
#include "gtkmm/widget.h"

RaWidget::RaWidget() :
    // GType 名会是 gtkmm__CustomObject_RaWidget
    Glib::ObjectBase("RaWidget"),
    // base con
    Gtk::Widget() {}

// 下面都只是调用了 Gtk::Widget 的方法，没有修改

Gtk::SizeRequestMode RaWidget::get_request_mode_vfunc() const {
    return Gtk::Widget::get_request_mode_vfunc();
}

void RaWidget::measure_vfunc(Gtk::Orientation orientation,
                             int for_size,
                             int& minimum,
                             int& natural,
                             int& minimum_baseline,
                             int& natural_baseline) const {
    if (orientation == Gtk::Orientation::HORIZONTAL) {
        // width
        minimum = 60;
        natural = 100;
    }
    else if (orientation == Gtk::Orientation::VERTICAL) {
        // height
        minimum = 50;
        natural = 70;
    }
    // disable baseline alignment
    minimum_baseline = -1;
    natural_baseline = -1;
}

void RaWidget::on_map() {
    Gtk::Widget::on_map();
}

void RaWidget::on_unmap() {
    Gtk::Widget::on_unmap();
}

void RaWidget::on_realize() {
    Gtk::Widget::on_realize();
}

void RaWidget::on_unrealize() {
    Gtk::Widget::on_unrealize();
}

void RaWidget::snapshot_vfunc(const Glib::RefPtr<Gtk::Snapshot>& snapshot) {
    Gtk::Widget::snapshot_vfunc(snapshot);
}
```
